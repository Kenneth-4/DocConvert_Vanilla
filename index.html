<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convert DOC/DOCX to PDF</title>
    <link rel="stylesheet" href="css/index.css">
    <!--<link rel="stylesheet" href="css/main.css">-->
</head>
<body>
    <header class="navbar">
        <div class="container navbar-container">
            <a href="index.html" class="logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L3 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                </div>
                <span>DocConvert</span>
            </a>

            <nav class="nav-links">
                <a href="#all">All Tools</a>
                <a href="#all">Pricing</a>
                <a href="#all">API</a>
                <a href="#all">Contact Us</a>
            </nav>

            <div class="auth-links">
                <a href="login.html" class="login-link">Login</a>
                <a href="signup.html" class="signup-btn">Sign Up</a>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <main>
        <section class="hero-section">
            <div class="container">
                <h1 class="hero-title">Convert Word to PDF</h1>
                <p class="hero-subtitle">High-quality conversion to transform your DOC and DOCX files into PDF documents
                    that look exactly like the original.</p>

                <div class="upload-card">
                    <div class="drop-zone" id="dropzone">
                        <input type="file" id="fileInput" accept=".docx" hidden>

                        <div class="drop-content">
                            <div class="drop-icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="12" y1="18" x2="12" y2="12"></line>
                                    <line x1="9" y1="15" x2="15" y2="15"></line>
                                </svg>
                            </div>
                            <h2>Drag and drop Word files here</h2>
                            <p class="drop-subtext">or select a file from your computer</p>

                            <button type="button" class="btn-primary" id="browseBtn">Select Word file</button>

                            <div class="secure-note">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                </svg>
                                <span>SECURE PROCESSING</span>
                            </div>
                            <p id="fileInfo"></p>
                        </div>
                    </div>

                    <div class="upload-confirm hidden" id="uploadConfirm">
                        <div class="upload-confirm-content">
                            <div class="upload-confirm-icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="12" y1="18" x2="12" y2="12"></line>
                                    <line x1="9" y1="15" x2="15" y2="15"></line>
                                </svg>
                            </div>
                            <h2>File ready to convert</h2>
                            <p class="uploaded-file-name" id="uploadedFileName"></p>
                            <div class="upload-confirm-actions">
                                <button type="button" class="btn-primary" id="confirmConvertBtn">Convert &amp; Download</button>
                                <button type="button" class="btn-text" id="chooseAnotherBtn">Choose another file</button>
                            </div>
                            <p class="upload-confirm-error hidden" id="convertError"></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- How it Works Section -->
        <section class="how-it-works">
            <div class="container">
                <h2 class="section-title">How it works</h2>

                <div class="steps-grid">
                    <!-- Step 1 -->
                    <div class="step-card">
                        <div class="step-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                        </div>
                        <h3>1. Upload files</h3>
                        <p>Choose the Word documents (.doc or .docx) you want to transform from your device or drag them
                            into the box.</p>
                    </div>

                    <!-- Step 2 -->
                    <div class="step-card">
                        <div class="step-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path
                                    d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                                </path>
                            </svg>
                        </div>
                        <h3>2. Click Convert</h3>
                        <p>Our cloud-based tool quickly processes your files, maintaining formatting, fonts, and images.
                        </p>
                    </div>

                    <!-- Step 3 -->
                    <div class="step-card">
                        <div class="step-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                        </div>
                        <h3>3. Download PDF</h3>
                        <p>Your PDF is ready! Save the converted files directly to your computer or upload them to your
                            cloud storage.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- More Tools Section -->
        <section class="tools-section">
            <div class="container">
                <h2 class="section-title">More conversion tools</h2>

                <div class="footer-links-grid">
                    <div class="links-column">
                        <h4>Convert To PDF</h4>
                        <ul>
                            <li><a href="#">Word to PDF</a></li>
                            <li><a href="#">JPG to PDF</a></li>
                            <li><a href="#">Excel to PDF</a></li>
                            <li><a href="#">PPT to PDF</a></li>
                        </ul>
                    </div>
                    <div class="links-column">
                        <h4>Convert From PDF</h4>
                        <ul>
                            <li><a href="#">PDF to Word</a></li>
                            <li><a href="#">PDF to JPG</a></li>
                            <li><a href="#">PDF to Excel</a></li>
                            <li><a href="#">PDF to PPT</a></li>
                        </ul>
                    </div>
                    <div class="links-column">
                        <h4>Optimize PDF</h4>
                        <ul>
                            <li><a href="#">Merge PDF</a></li>
                            <li><a href="#">Split PDF</a></li>
                            <li><a href="#">Compress PDF</a></li>
                            <li><a href="#">Repair PDF</a></li>
                        </ul>
                    </div>
                    <div class="links-column">
                        <h4>Company</h4>
                        <ul>
                            <li><a href="#">About Us</a></li>
                            <li><a href="contact_us.html">Contact</a></li>
                            <li><a href="privacy_policy.html">Privacy Policy</a></li>
                            <li><a href="#">Terms of Use</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container footer-content">
            <div class="footer-brand">
                <div class="logo-icon small">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                </div>
                <span>Â© 2026 DocConvert. All rights reserved.</span>
            </div>

            <div class="social-links">
                <a href="#" aria-label="Language">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="2" y1="12" x2="22" y2="12"></line>
                        <path
                            d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z">
                        </path>
                    </svg>
                </a>
                <a href="#" aria-label="Help">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                </a>
                <a href="#" aria-label="Social">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="18" cy="5" r="3"></circle>
                        <circle cx="6" cy="12" r="3"></circle>
                        <circle cx="18" cy="19" r="3"></circle>
                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                    </svg>
                </a>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://127.0.0.1:8000';

        const dropzone = document.getElementById('dropzone');
        const fileInput = document.getElementById('fileInput');
        const browseBtn = document.getElementById('browseBtn');
        const fileInfo = document.getElementById('fileInfo');
        const uploadConfirm = document.getElementById('uploadConfirm');
        const uploadedFileName = document.getElementById('uploadedFileName');
        const confirmConvertBtn = document.getElementById('confirmConvertBtn');
        const chooseAnotherBtn = document.getElementById('chooseAnotherBtn');
        const convertError = document.getElementById('convertError');

        let selectedFile = null;

        browseBtn.addEventListener('click', () => fileInput.click());

        fileInput.addEventListener('change', (e) => {
            if (e.target.files && e.target.files.length) handleFiles(e.target.files);
        });

        dropzone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropzone.classList.add('drag-over');
        });

        dropzone.addEventListener('dragleave', () => dropzone.classList.remove('drag-over'));

        dropzone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropzone.classList.remove('drag-over');
            if (e.dataTransfer.files && e.dataTransfer.files.length) handleFiles(e.dataTransfer.files);
        });

        chooseAnotherBtn.addEventListener('click', resetToDropZone);

        confirmConvertBtn.addEventListener('click', async () => {
            if (!selectedFile) return;
            confirmConvertBtn.disabled = true;
            confirmConvertBtn.textContent = 'Converting...';
            convertError.classList.add('hidden');
            convertError.textContent = '';

            const form = new FormData();
            form.append('file', selectedFile);

            try {
                const res = await fetch(`${API_BASE}/convert/doc-to-pdf`, {
                    method: 'POST',
                    body: form,
                });
                if (!res.ok) {
                    const err = await res.json().catch(() => ({}));
                    throw new Error(err.detail || `Request failed: ${res.status}`);
                }
                const blob = await res.blob();
                const name = (res.headers.get('Content-Disposition') || '')
                    .match(/filename="?([^";\n]+)"?/)?.[1] || selectedFile.name.replace(/\.docx$/i, '.pdf');
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = name;
                a.click();
                URL.revokeObjectURL(url);
                resetToDropZone();
            } catch (e) {
                convertError.textContent = e.message || 'Conversion failed.';
                convertError.classList.remove('hidden');
                confirmConvertBtn.textContent = 'Convert & Download';
                confirmConvertBtn.disabled = false;
            }
        });

       function handleFiles(files) {
            const valid = Array.from(files).find(f => /\.(docx?|doc)$/i.test(f.name));
            if (!valid) {
                fileInfo.textContent = 'Please select a Word file (.doc or .docx)';
                fileInfo.style.color = '#ef4444';
                return;
            }
            selectedFile = valid;
            fileInfo.textContent = '';
            uploadedFileName.textContent = valid.name;
            dropzone.classList.add('hidden');
            uploadConfirm.classList.remove('hidden');
        }

        function resetToDropZone() {
            selectedFile = null;
            fileInput.value = '';
            fileInfo.textContent = '';
            convertError.textContent = '';
            convertError.classList.add('hidden');
            confirmConvertBtn.textContent = 'Convert & Download';
            confirmConvertBtn.disabled = false;
            uploadConfirm.classList.add('hidden');
            dropzone.classList.remove('hidden');
        }
    </script>
</body>
</html>